{% extends "base.html" %}

{% block content %}
<!-- ...existing code... -->

<form method="POST" action="{{ url_for('datasets.register_dataset') }}">
    <div class="form-group">
        <label for="name">Dataset Name</label>
        <input type="text" class="form-control" id="name" name="name" 
               value="{{ name or '' }}" required 
               pattern="[a-zA-Z0-9\s\-_.]{3,100}"
               title="Only letters, numbers, spaces, hyphens, underscores, and periods allowed (3-100 characters)">
        <small class="form-text text-muted">
            Only alphanumeric characters, spaces, hyphens, underscores, and periods are allowed.
        </small>
        <div id="name-feedback" class="invalid-feedback"></div>
    </div>
    
    <!-- ...existing code... -->
</form>

<script>
document.getElementById('name').addEventListener('input', function() {
    const name = this.value;
    const feedback = document.getElementById('name-feedback');
    
    if (name.length >= 3) {
        fetch('{{ url_for("datasets.validate_name") }}', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({name: name})
        })
        .then(response => response.json())
        .then(data => {
            if (!data.valid) {
                this.classList.add('is-invalid');
                feedback.textContent = data.message;
            } else {
                this.classList.remove('is-invalid');
                this.classList.add('is-valid');
            }
        });
    } else {
        this.classList.remove('is-valid');
        this.classList.remove('is-invalid');
    }
});
</script>

{% endblock %}
